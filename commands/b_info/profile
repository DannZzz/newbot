const profileModel = require("../../models/profileSchema");
const memberModel = require("../../models/memberSchema");
const begModel = require("../../models/begSchema");
const canvacord = require("canvacord");
const { MessageEmbed, MessageAttachment } = require('discord.js');
const {greenlight, redlight, cyan} = require('../../JSON/colours.json');
const { COIN, BANK, STAR } = require('../../config');
const vipModel = require("../../models/vipSchema");


module.exports = {
  config: {
    name: 'ранг',
    aliases: ['rank'],
    category: 'b_info',
    description: 'Смотреть ранг участника',
    usage: '[участник]',
    acessableby: 'Для всех'
  },
  run: async (bot, message, args) => {
    let Embed = new MessageEmbed()
    .setTimestamp()
    .setAuthor(message.member.user.tag, message.member.user.displayAvatarURL({dynamic: true}))
    .setColor(redlight)
    let user = message.mentions.members.first() || message.guild.members.cache.get(args[0]) || message.guild.members.cache.find(r => r.user.username.toLowerCase() === args.join(' ').toLocaleLowerCase()) || message.guild.members.cache.find(r => r.displayName.toLowerCase() === args.join(' ').toLocaleLowerCase()) || message.member;
    if (user.user.bot) return message.channel.send(Embed.setDescription(`**Боты не имеют профиль!**`));

    const rank = new canvacord.Rank()
        .setAvatar(user.user.displayAvatarURL({format: 'jpg'}))
        .setCurrentXP(50)
        .setRequiredXP(120)
        .setStatus("dnd")
        .setProgressBar("#FFFFFF", "COLOR")
        .setUsername(user.user.username)
        .setDiscriminator(user.user.discriminator);

    rank.build()
      .then(data => {
          const attachment = new MessageAttachment(data, "RankCard.png");
          message.channel.send(attachment);
      });

  }
}
